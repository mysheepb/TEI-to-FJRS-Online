<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width">
    <title>CETEIcean Demo</title>
    <link rel="stylesheet" href="CETEIcean.css" media="screen" charset="utf-8">
  </head>
  <body>
    <div id="TEI">
      Sadly, this page will not work in Internet Explorer and some older browsers. We suggest you use a newer version of Chrome or Firefox.
    </div>
    <script src="CETEI.js"></script>
    <script>
      var CETEIcean = new CETEI();

      CETEIcean.addBehaviors({
        "tei":{
        "note": function(elt){
          if (!this.noteIndex){
            this["noteIndex"] = 1;
          } else {
            this.noteIndex++;
          }
          let id = "_note_" + this.noteIndex;
          var str = String(elt.innerHTML);
          str = str.replace(/<[^>]+>/g,"");
          let link = document.createElement("a");
          link.setAttribute("id", "src" + id);
          link.setAttribute("href", "#" + id);
         // link.setAttribute("title",elt.innerHTML)
          link.setAttribute("title",str)
          link.innerHTML = this.noteIndex;
          let content = document.createElement("sup");
          content.appendChild(link);
          let notes = this.dom.querySelector("ol.notes");
          if (!notes) {
            notes = document.createElement("ol");
            notes.setAttribute("class", "notes");
            this.dom.appendChild(notes);
          }
          let note = document.createElement("li");
          note.id = id;
          note.innerHTML = elt.innerHTML;
          notes.appendChild(note);
          let el = document.getElementById(note.id);
          el.innerHTML = '<span><a href="#ftn'+this.noteIndex + '">' + "^" + '</a></span>'+elt.innerHTML;
          return content;
        }
        }
      })
      CETEIcean.getHTML5('./tei/24-04.xml', function(data) {
        document.getElementById("TEI",).innerHTML = "";
        document.getElementById("TEI").appendChild(data);
        CETEIcean.addStyle(document, data);
      });
      

      // Alternatively, use then()
      // (new CETEI).getHTML5('testTEI.xml').then(function(data){
      //   document.getElementById("TEI").appendChild(data);
      // });

    </script>
  </body>
</html>